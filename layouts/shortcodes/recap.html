{{/*
recap.html shortcode
Usage:
{{< recap image="img.webp" title="Title" link="https://example.com" >}}
Content here (markdown allowed)
{{< /recap >}}
*/}}

<section class="recap" aria-label="{{ .Get "title" }}"
  {{ if .Get "bg" }}style="background-image: url(/images/recap/{{ .Get "image" }})"{{ end }}>
  <div class="slide">
    <div class="header">
      <h3>{{ .Page.Title }}</h3>
      <br>
      <h2>{{ .Get "title" }}</h2>
    </div>
    <div class="content">

      {{ .Inner | markdownify }}
      {{ if .Get "link" }}
        {{ $link := .Get "link" }}
        {{ $domain := replaceRE `https?://(www\.)?([^/]+).*` `$2` $link }}
        {{ $domainNoTLD := replaceRE `\.[^.]+$` "" $domain }}
        {{ $domainParts := split $domainNoTLD "." }}
        {{ $mainDomain := index $domainParts (sub (len $domainParts) 1) }}
        <a href="{{ $link }}" class="button" target="{{ $mainDomain }}">{{ $mainDomain }} review</a>
      {{ end }}
    </div>
  </div>
</section>
