<!--
    Resources Loading Logic:
    - For each value in the post's frontmatter 'resources' array:
        - Check if "js/lib/ITEM.min.js" exists:
            - If it exists, include it.
        - If "js/lib/ITEM.min.js" does not exist, check for "js/lib/ITEM.js".
            - If it exists, include it.
        - If both exist, prefer "ITEM.min.js".
        - If neither exists, skip the resource.
-->
{{ with index .Params "resources" }}
  {{ range . }}
    {{ $libMin := printf "js/lib/%s.min.js" . }}
    {{ $lib := printf "js/lib/%s.js" . }}
    {{ if (fileExists (printf "static/%s" $libMin)) }}
      <script src="{{ $libMin | absURL }}"></script>
    {{ else if (fileExists (printf "static/%s" $lib)) }}
      <script src="{{ $lib | absURL }}"></script>
    {{ else }}
      <!-- WARNING: Resource "js/lib/{{ . }}" not found -->
    {{ end }}
  {{ end }}
{{ else }}
  <!-- WARNING: No resources found in frontmatter -->
{{ end }}

<!--
    Style-based JS script loading logic:
    - Check if a script matching the post styles exists in /js/script/:
        - If "js/script/NAME.min.js" exists, include it.
        - If "js/script/NAME.min.js" does not exist, check for "js/script/NAME.js".
        - If "js/script/NAME.js" exists, include it.
        - If neither exists, skip the script.
    - This ensures that the minified version is preferred if both are available.
-->
{{ with .Params.style }}
  {{ range . }}
    {{ $styleScriptMin := printf "js/script/%s.min.js" . }}
    {{ $styleScript := printf "js/script/%s.js" . }}
    {{ if (fileExists (printf "static/%s" $styleScriptMin)) }}
      <script src="{{ $styleScriptMin | absURL }}"></script>
    {{ else if (fileExists (printf "static/%s" $styleScript)) }}
      <script src="{{ $styleScript | absURL }}"></script>
    {{ else }}
      <!-- WARNING: No script found for style "{{ . }}" -->
    {{ end }}
  {{ end }}
{{ end }}

<!--
    Slug-based JS script loading logic:
    - Check if a script matching the post slug exists in /js/script/:
        - If "js/script/SLUG.min.js" exists, include it.
        - If "js/script/SLUG.min.js" does not exist, check for "js/script/SLUG.js".
        - If "js/script/SLUG.js" exists, include it.
        - If neither exists, skip the script.
    - This ensures that the minified version is preferred if both are available.
-->
{{ $slug := .File.BaseFileName }}
{{ $slugScriptMin := printf "js/script/%s.min.js" $slug }}
{{ $slugScript := printf "js/script/%s.js" $slug }}

{{ if (fileExists (printf "static/%s" $slugScriptMin)) }}
  <script src="{{ $slugScriptMin | absURL }}"></script>
{{ else if (fileExists (printf "static/%s" $slugScript)) }}
  <script src="{{ $slugScript | absURL }}"></script>
{{ else }}
  <!-- WARNING: No script found for slug "{{ $slug }}" -->
{{ end }}

<!--
    Global Scripts:
    - Tooltip initialization.
    - Popover initialization.
-->
<script>
  document.documentElement.classList.remove("no-js");
  document.documentElement.classList.add("js");
</script>

<script src="{{ printf "js/global/popper.min.js" | absURL }}"></script>
<script src="{{ printf "js/global/tippy-bundle.umd.min.js" | absURL }}"></script>

<script>
  document.querySelectorAll(".tooltip").forEach((el) => {
    const tipId = el.getAttribute("data-tooltip-id");
    const content =
      document.getElementById(tipId)?.innerHTML || "No content";

    tippy(el, {
      content,
      allowHTML: true,
      interactive: true,
    });
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
    var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
      return new bootstrap.Popover(popoverTriggerEl, {
        trigger: 'hover',
        html: true
      });
    });
  });
</script>



